!! THIS README IS NOT UP TO DATE !!

# Jisho Matcher 语法使用指南

Jisho Matcher 采用类 Qat 的语法设计进行日语词汇匹配.

## 1. 背景介绍

Jisho Matcher 采用豚辞書，收录约二十万条日语词汇。

注意：

1. 该辞書的所有词语均用平假名和长音符号呈现，所有片假名词语都已经过平假名化处理，设计匹配时无需考虑片假名。
2. 该辞書的所有促音っ，拗音ゃゅょ，捨て仮名ぁぃぅぇぉ等都被正体化大写，与正常假名无异，设计匹配时无需考虑。

**兼容性说明**
为便利用户使用，Jisho Matcher 对特殊符号的使用有很高的包容度 (即便利日语键盘的输入)。
如?可以与？等价交换使用，()与（）可以交换使用等等。

## 2. 核心匹配语法

Jisho Matcher 可以使用如下配对方式：

1. 直接使用假名匹配
2. 使用假名的属性（段，行）匹配
3. 利用成词条件匹配

### 2.1 基础通配符

`?`: 单个假名（包括长音符号ー）
`*`: 多个假名（包括0个）
`*[m-n]`:  m-n个假名，`m-`表示>=m个，`-n`表示<=n个
注：?不可使用带长度的[]判定

### 2.2 属性匹配

我们使用小写字母以匹配段，行与特殊字符：
`[kst]`: 匹配か行，さ行和た行的假名
`[ae]`: 匹配あ段和え段的假名
`[nn]`: 匹配ん
`[gdp]`: 匹配が行，だ行和ぱ行的假名
`[ksba]`: 匹配在か行，さ行，ば行和あ段上的字符
特殊地：あ行用aa表示，ん用nn表示

### 2.3 逻辑运算符

您可以使用＆，|，与！(或!)来进行条件并列：
`*[1-3&ks]`: 匹配1-3个か行与さ行的字符
`?[g|d]`: 匹配一个が行或だ行的字符
`?[!あのみ]`: 匹配一个不是あのみ三个之一的字符

对于多个条件的嵌套，请使用`()`或者`（）`划定范围：
`?[(!ai)&stn]`:匹配不在あ段，い段，且在さ行，た行和な行的字符。

## 3. 进阶功能

Jisho Matcher 提供重排操作，用`<>`或`＜＞`包裹：

`<ありう??>`: 匹配所有包含ありう的五字符词语
`えく<?ね>`: 匹配所有以えく开头，且三四字符包含ね的四字符词语

Jisho Matcher 提供成词条件匹配，用＠或＠表示：

`そと@`: 匹配所有以そと开头，尾部可独立成词的所有词语
`*[(1-3&st)&(!i)]@`:匹配所有由1-3个不在い段的さ行，た行假名开头，尾部可独立成词的所有词语

## 4. 复合表达式

除匹配单字符可使用逻辑并列，多个匹配句也可以使用并列结构（即&，|，与！）。

`??[!そ]そ??|?そ?[!そ]??`: 匹配所有第二个/第三个字符中有且仅有一个是そ的五字符词语

## 5. 代数式匹配

本模块可参考qat的部分，未知子串用大写字母表示。
同一表达式的字母所表达的假名组合是相等的。

`ABA;|A|=1;|B|=2`
	匹配所有符合`ABA`结构的词语，其中`A`是单字符，`B`是两字符
	该表达式等价匹配：匹配所有四字符长，且首尾字符相同的短语

`ABそ;B;|A|=1`
	匹配所有符合`ABそ`的词语，其中`A`是单字符，`B`可单独成词
	该表达式等价匹配：匹配所有以そ结尾，且去掉首尾后剩余部分仍可成词的词语

注：若某表达式没有对未知字母长度的明确声明，如`|A|=1`，则默认为>=1的任意长子串

Jisho Matcher 的数学运算可以与前文的语法并列，具体可以使用在：

1. 成句
2. 赋值

成句：
`AB?ま;A;B`
	匹配所有最后一个字符为ま，且去除末尾两个字符后可以拆成两个部分独立成词的词语

赋值：
`AB;B=まと*|そと*;|A|=1`
	匹配所有第二三个字符为まと或そと的词语



